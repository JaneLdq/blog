<svg id="SvgjsSvg1006" width="1023" height="782" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1044" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1045" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1054" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1055" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1064" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1065" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1072" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1073" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1080" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1081" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1088" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1089" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1096" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1097" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1104" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1105" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><marker id="SvgjsMarker1112" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1113" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1122" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1123" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1130" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1131" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1138" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1139" d="M0,2 L14,6 L0,11 L0,2" fill="#ff9933" stroke="#ff9933" stroke-width="2"></path></marker><marker id="SvgjsMarker1146" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1147" d="M0,2 L14,6 L0,11 L0,2" fill="#3399ff" stroke="#3399ff" stroke-width="2"></path></marker><pattern id="SvgjsPattern1174" x="0" y="0" width="24" height="24" patternUnits="userSpaceOnUse"><image id="SvgjsImage1175" xlink:href="https://cdn2.iconfinder.com/data/icons/circle-icons-1/64/locked-24.png" width="24" height="24" preserveAspectRatio="none" crossOrigin="anonymous" x="0" y="0"></image></pattern><pattern id="SvgjsPattern1206" x="0" y="0" width="24" height="24" patternUnits="userSpaceOnUse"><image id="SvgjsImage1207" xlink:href="https://cdn2.iconfinder.com/data/icons/circle-icons-1/64/locked-24.png" width="24" height="24" preserveAspectRatio="none" crossOrigin="anonymous" x="0" y="0"></image></pattern><pattern id="SvgjsPattern1210" x="0" y="0" width="24" height="24" patternUnits="userSpaceOnUse"><image id="SvgjsImage1211" xlink:href="https://cdn2.iconfinder.com/data/icons/circle-icons-1/64/locked-24.png" width="24" height="24" preserveAspectRatio="none" crossOrigin="anonymous" x="0" y="0"></image></pattern></defs><g id="SvgjsG1008" transform="translate(226,538)"><path id="SvgjsPath1009" d="M 0 54.5L 54.5 0L 54.5 35.97L 446 35.97L 446 73.03L 54.5 73.03L 54.5 109L 0 54.5Z" stroke="none" fill-opacity="0.5" fill="#cce5ff"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="Arial" text-anchor="middle" font-size="13px" width="0" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="44.55" transform="rotate(0)"></text></g></g><g id="SvgjsG1012" transform="translate(226,324)"><path id="SvgjsPath1013" d="M 0 68.97L 341.5 68.97L 341.5 0L 446 104.5L 341.5 209L 341.5 140.03L 0 140.03L 0 68.97Z" stroke="none" fill-opacity="0.5" fill="#ffe6cc"></path><g id="SvgjsG1014"><text id="SvgjsText1015" font-family="Arial" text-anchor="middle" font-size="13px" width="0" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="94.55" transform="rotate(0)"></text></g></g><g id="SvgjsG1016" transform="translate(226,89)"><path id="SvgjsPath1017" d="M 0 19.470000000000002L 416.5 19.470000000000002L 416.5 0L 446 29.5L 416.5 59L 416.5 39.53L 0 39.53L 0 19.470000000000002Z" stroke="none" fill-opacity="0.5" fill="#ffe6cc"></path><g id="SvgjsG1018"><text id="SvgjsText1019" font-family="Arial" text-anchor="middle" font-size="13px" width="0" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="19.550000000000004" transform="rotate(0)"></text></g></g><g id="SvgjsG1020" transform="translate(226,140)"><path id="SvgjsPath1021" d="M 0 92L 92 0L 92 60.720000000000006L 446 60.720000000000006L 446 123.28L 92 123.28L 92 184L 0 92Z" stroke="none" fill-opacity="0.5" fill="#cce5ff"></path><g id="SvgjsG1022"><text id="SvgjsText1023" font-family="Arial" text-anchor="middle" font-size="13px" width="0" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="82.05" transform="rotate(0)"></text></g></g><g id="SvgjsG1024" transform="translate(139,25)"><path id="SvgjsPath1025" d="M 48 30L 48 732" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1026" d="M 0 0L 96 0L 96 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1027"><text id="SvgjsText1028" font-family="Arial" text-anchor="middle" font-size="13px" width="33" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1029" dy="16" x="48"><tspan id="SvgjsTspan1030" style="text-decoration:;">Client</tspan></tspan></text></g></g><g id="SvgjsG1031" transform="translate(659,25)"><path id="SvgjsPath1032" d="M 44.5 30L 44.5 732" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1033" d="M 0 0L 89 0L 89 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1034"><text id="SvgjsText1035" font-family="Arial" text-anchor="middle" font-size="13px" width="38" fill="#323232" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1036" dy="16" x="44.5"><tspan id="SvgjsTspan1037" style="text-decoration:;">Server</tspan></tspan></text></g></g><g id="SvgjsG1038" transform="translate(172,97)"><path id="SvgjsPath1039" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 619Q 30 623 26 623L 4 623Q 0 623 0 619L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1040" transform="translate(688.5,97)"><path id="SvgjsPath1041" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 619Q 30 623 26 623L 4 623Q 0 623 0 619L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1042"><path id="SvgjsPath1043" d="M200 120L688.5 120" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1044)"></path><rect id="SvgjsRect1046" width="349" height="32" x="269.75" y="104" fill="#ffffff"></rect><text id="SvgjsText1047" font-family="Arial" text-anchor="middle" font-size="13px" width="349" fill="#ff9933" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="102.05" transform="rotate(0)"><tspan id="SvgjsTspan1048" dy="16" x="444.25"><tspan id="SvgjsTspan1049" style="text-decoration:;">ClientHello</tspan></tspan><tspan id="SvgjsTspan1050" dy="16" x="444.25"><tspan id="SvgjsTspan1051" style="text-decoration:;">(version, session id, cipher suites &amp; compress methods)</tspan></tspan></text></g><g id="SvgjsG1052"><path id="SvgjsPath1053" d="M688.5 166L202 167" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1054)"></path><rect id="SvgjsRect1056" width="390" height="32" x="250.25" y="150.5" fill="#ffffff"></rect><text id="SvgjsText1057" font-family="Arial" text-anchor="middle" font-size="13px" width="390" fill="#004c99" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="148.55" transform="rotate(0)"><tspan id="SvgjsTspan1058" dy="16" x="445.25"><tspan id="SvgjsTspan1059" style="text-decoration:;">ServerHello</tspan></tspan><tspan id="SvgjsTspan1060" dy="16" x="445.25"><tspan id="SvgjsTspan1061" style="text-decoration:;">(version, session id, selected cipher suite &amp; compress method)</tspan></tspan></text></g><g id="SvgjsG1062"><path id="SvgjsPath1063" d="M202 348L688.5 346" stroke-dasharray="8,5" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1064)"></path><rect id="SvgjsRect1066" width="92" height="16" x="399.25" y="339" fill="#ffffff"></rect><text id="SvgjsText1067" font-family="Arial" text-anchor="middle" font-size="13px" width="92" fill="#ff9933" font-weight="400" align="top" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="337.05" transform="rotate(0)"><tspan id="SvgjsTspan1068" dy="16" x="445.25"><tspan id="SvgjsTspan1069" style="text-decoration:;">ClientCertificate</tspan></tspan></text></g><g id="SvgjsG1070"><path id="SvgjsPath1071" d="M688.5 569L202 569" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1072)"></path><rect id="SvgjsRect1074" width="120" height="16" x="385.25" y="561" fill="#ffffff"></rect><text id="SvgjsText1075" font-family="Arial" text-anchor="middle" font-size="13px" width="120" fill="#004c99" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="559.05" transform="rotate(0)"><tspan id="SvgjsTspan1076" dy="16" x="445.25"><tspan id="SvgjsTspan1077" style="text-decoration:;">ChangeCipherSpec</tspan></tspan></text></g><g id="SvgjsG1078"><path id="SvgjsPath1079" d="M688.5 195L201 195" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1080)"></path><rect id="SvgjsRect1082" width="64" height="16" x="412.75" y="187" fill="#ffffff"></rect><text id="SvgjsText1083" font-family="Arial" text-anchor="middle" font-size="13px" width="64" fill="#004c99" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="185.05" transform="rotate(0)"><tspan id="SvgjsTspan1084" dy="16" x="444.75"><tspan id="SvgjsTspan1085" style="text-decoration:;">Certificate</tspan></tspan></text></g><g id="SvgjsG1086"><path id="SvgjsPath1087" d="M688.5 227L202 226" stroke-dasharray="8,5" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1088)"></path><rect id="SvgjsRect1090" width="119" height="16" x="385.75" y="218.5" fill="#ffffff"></rect><text id="SvgjsText1091" font-family="Arial" text-anchor="middle" font-size="13px" width="119" fill="#004c99" font-weight="400" align="top" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="216.55" transform="rotate(0)"><tspan id="SvgjsTspan1092" dy="16" x="445.25"><tspan id="SvgjsTspan1093" style="text-decoration:;">ServerKeyExchange</tspan></tspan></text></g><g id="SvgjsG1094"><path id="SvgjsPath1095" d="M688.5 257L201 256" stroke-dasharray="8,5" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1096)"></path><rect id="SvgjsRect1098" width="107" height="16" x="391.25" y="248.5" fill="#ffffff"></rect><text id="SvgjsText1099" font-family="Arial" text-anchor="middle" font-size="13px" width="107" fill="#004c99" font-weight="400" align="top" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="246.55" transform="rotate(0)"><tspan id="SvgjsTspan1100" dy="16" x="444.75"><tspan id="SvgjsTspan1101" style="text-decoration:;">CertificateRequest</tspan></tspan></text></g><g id="SvgjsG1102"><path id="SvgjsPath1103" d="M688.5 287L202 286" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1104)"></path><rect id="SvgjsRect1106" width="105" height="16" x="392.75" y="278.5" fill="#ffffff"></rect><text id="SvgjsText1107" font-family="Arial" text-anchor="middle" font-size="13px" width="105" fill="#004c99" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="276.55" transform="rotate(0)"><tspan id="SvgjsTspan1108" dy="16" x="445.25"><tspan id="SvgjsTspan1109" style="text-decoration:;">ServerHelloDone</tspan></tspan></text></g><g id="SvgjsG1110"><path id="SvgjsPath1111" d="M202 377L688.5 377" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1112)"></path><rect id="SvgjsRect1114" width="131" height="32" x="379.75" y="361" fill="#ffffff"></rect><text id="SvgjsText1115" font-family="Arial" text-anchor="middle" font-size="13px" width="131" fill="#ff9933" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="359.05" transform="rotate(0)"><tspan id="SvgjsTspan1116" dy="16" x="445.25"><tspan id="SvgjsTspan1117" style="text-decoration:;">CientKeyExchange</tspan></tspan><tspan id="SvgjsTspan1118" dy="16" x="445.25"><tspan id="SvgjsTspan1119" style="text-decoration:;">（premaster secret）</tspan></tspan></text></g><g id="SvgjsG1120"><path id="SvgjsPath1121" d="M202 447L689 447" stroke-dasharray="8,5" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1122)"></path><rect id="SvgjsRect1124" width="91" height="16" x="400" y="439" fill="#ffffff"></rect><text id="SvgjsText1125" font-family="Arial" text-anchor="middle" font-size="13px" width="91" fill="#ff9933" font-weight="400" align="top" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="437.05" transform="rotate(0)"><tspan id="SvgjsTspan1126" dy="16" x="445.5"><tspan id="SvgjsTspan1127" style="text-decoration:;">CertificateVerify</tspan></tspan></text></g><g id="SvgjsG1128"><path id="SvgjsPath1129" d="M202 480L688.5 481" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1130)"></path><rect id="SvgjsRect1132" width="120" height="16" x="385.25" y="472.5" fill="#ffffff"></rect><text id="SvgjsText1133" font-family="Arial" text-anchor="middle" font-size="13px" width="120" fill="#ff9933" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="470.55" transform="rotate(0)"><tspan id="SvgjsTspan1134" dy="16" x="445.25"><tspan id="SvgjsTspan1135" style="text-decoration:;">ChangeCipherSpec</tspan></tspan></text></g><g id="SvgjsG1136"><path id="SvgjsPath1137" d="M202 511L688.5 511" stroke="#ff9933" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1138)"></path><rect id="SvgjsRect1140" width="53" height="16" x="418.75" y="503" fill="#ffffff"></rect><text id="SvgjsText1141" font-family="Arial" text-anchor="middle" font-size="13px" width="53" fill="#ff9933" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="501.05" transform="rotate(0)"><tspan id="SvgjsTspan1142" dy="16" x="445.25"><tspan id="SvgjsTspan1143" style="text-decoration:;">Finished</tspan></tspan></text></g><g id="SvgjsG1144"><path id="SvgjsPath1145" d="M688.5 602L202 600" stroke="#3399ff" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1146)"></path><rect id="SvgjsRect1148" width="53" height="16" x="418.75" y="593" fill="#ffffff"></rect><text id="SvgjsText1149" font-family="Arial" text-anchor="middle" font-size="13px" width="53" fill="#004c99" font-weight="700" align="top" anchor="middle" family="Arial" size="13px" weight="700" font-style="" y="591.05" transform="rotate(0)"><tspan id="SvgjsTspan1150" dy="16" x="445.25"><tspan id="SvgjsTspan1151" style="text-decoration:;">Finished</tspan></tspan></text></g><g id="SvgjsG1152" transform="translate(728,372.5)"><path id="SvgjsPath1153" d="M 0 0L 254 0L 270 16L 270 112L 0 112L 0 0Z" stroke="none" fill-opacity="1" fill="#e5e5e5"></path><path id="SvgjsPath1154" d="M 254 0L 254 16L 270 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1155" d="M 0 0L 254 0L 270 16L 270 112L 0 112L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1156"><text id="SvgjsText1157" font-family="Arial" text-anchor="start" font-size="12px" width="245" fill="#323232" font-weight="400" align="middle" anchor="start" family="Arial" size="12px" weight="400" font-style="" y="1.7000000000000002" transform="rotate(0)"><tspan id="SvgjsTspan1158" dy="15" x="10"><tspan id="SvgjsTspan1159" style="text-decoration:;">交换 premaster secret</tspan></tspan><tspan id="SvgjsTspan1160" dy="15" x="10"><tspan id="SvgjsTspan1161" style="text-decoration:;">双方基于 premaster secret 生成 master secret</tspan></tspan><tspan id="SvgjsTspan1162" dy="15" x="10"><tspan id="SvgjsTspan1163" style="text-decoration:;">master secret 被划分为四个密钥：</tspan></tspan><tspan id="SvgjsTspan1164" dy="15" x="10"><tspan id="SvgjsTspan1165" style="text-decoration:;">client write MAC key</tspan></tspan><tspan id="SvgjsTspan1166" dy="15" x="10"><tspan id="SvgjsTspan1167" style="text-decoration:;">client write encryption key</tspan></tspan><tspan id="SvgjsTspan1168" dy="15" x="10"><tspan id="SvgjsTspan1169" style="text-decoration:;">server write MAC key</tspan></tspan><tspan id="SvgjsTspan1170" dy="15" x="10"><tspan id="SvgjsTspan1171" style="text-decoration:;">server write encryption key</tspan></tspan></text></g></g><g id="SvgjsG1172" transform="translate(387,501)"><path id="SvgjsPath1173" d="M 0 0L 24 0L 24 24L 0 24Z" stroke="none" fill="url(#SvgjsPattern1174)"></path></g><g id="SvgjsG1176" transform="translate(728,513.25)"><path id="SvgjsPath1177" d="M 0 0L 254 0L 270 16L 270 122.75L 0 122.75L 0 0Z" stroke="none" fill-opacity="1" fill="#ffe6cc"></path><path id="SvgjsPath1178" d="M 254 0L 254 16L 270 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1179" d="M 0 0L 254 0L 270 16L 270 122.75L 0 122.75L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1180"><text id="SvgjsText1181" font-family="Arial" text-anchor="start" font-size="12px" width="241" fill="#323232" font-weight="400" align="middle" anchor="start" family="Arial" size="12px" weight="400" font-style="" y="-0.4249999999999998" transform="rotate(0)"><tspan id="SvgjsTspan1182" dy="15" x="10"><tspan id="SvgjsTspan1183" style="text-decoration:;">Finished 消息是第一条使用协商后的密钥保护</tspan></tspan><tspan id="SvgjsTspan1184" dy="15" x="10"><tspan id="SvgjsTspan1185" style="text-decoration:;">的消息。</tspan></tspan><tspan id="SvgjsTspan1186" dy="15" x="10"><tspan id="SvgjsTspan1187" style="text-decoration:;">客户端使用 client write MAC key 计算其 MAC </tspan></tspan><tspan id="SvgjsTspan1188" dy="15" x="10"><tspan id="SvgjsTspan1189" style="text-decoration:;">用于完整性验证，然后使用 client write </tspan></tspan><tspan id="SvgjsTspan1190" dy="15" x="10"><tspan id="SvgjsTspan1191" style="text-decoration:;">encrpytion key 对消息加密。</tspan></tspan><tspan id="SvgjsTspan1192" dy="15" x="10"><tspan id="SvgjsTspan1193" style="text-decoration:;">服务器收到消息后使用对应的密钥解密并验证</tspan></tspan><tspan id="SvgjsTspan1194" dy="15" x="10"><tspan id="SvgjsTspan1195" style="text-decoration:;">消息完整性，同时可确认协商后的密钥是否能</tspan></tspan><tspan id="SvgjsTspan1196" dy="15" x="10"><tspan id="SvgjsTspan1197" style="text-decoration:;">正确使用。</tspan></tspan></text></g></g><g id="SvgjsG1198" transform="translate(202,650)"><path id="SvgjsPath1199" d="M 0 27.5L 27.5 0L 27.5 18.150000000000002L 459 18.150000000000002L 459 0L 486.5 27.5L 459 55L 459 36.85L 27.5 36.85L 27.5 55L 0 27.5Z" stroke="none" fill-opacity="1" fill="#5c5c5c"></path><g id="SvgjsG1200"><text id="SvgjsText1201" font-family="Arial" text-anchor="middle" font-size="13px" width="95" fill="#ffffff" font-weight="400" align="middle" anchor="middle" family="Arial" size="13px" weight="400" font-style="" y="17.550000000000004" transform="rotate(0)"><tspan id="SvgjsTspan1202" dy="16" x="243.5"><tspan id="SvgjsTspan1203" style="text-decoration:;">Application Data</tspan></tspan></text></g></g><g id="SvgjsG1204" transform="translate(484,589)"><path id="SvgjsPath1205" d="M 0 0L 24 0L 24 24L 0 24Z" stroke="none" fill="url(#SvgjsPattern1206)"></path></g><g id="SvgjsG1208" transform="translate(363,665.5)"><path id="SvgjsPath1209" d="M 0 0L 24 0L 24 24L 0 24Z" stroke="none" fill="url(#SvgjsPattern1210)"></path></g><g id="SvgjsG1212" transform="translate(728,152.25)"><path id="SvgjsPath1213" d="M 0 0L 254 0L 270 16L 270 83.75L 0 83.75L 0 0Z" stroke="none" fill-opacity="1" fill="#cce5ff"></path><path id="SvgjsPath1214" d="M 254 0L 254 16L 270 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1215" d="M 0 0L 254 0L 270 16L 270 83.75L 0 83.75L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1216"><text id="SvgjsText1217" font-family="Arial" text-anchor="start" font-size="12px" width="240" fill="#323232" font-weight="400" align="middle" anchor="start" family="Arial" size="12px" weight="400" font-style="" y="17.575" transform="rotate(0)"><tspan id="SvgjsTspan1218" dy="15" x="10"><tspan id="SvgjsTspan1219" style="text-decoration:;">服务器从客户端提供的加密套件列表和压缩方</tspan></tspan><tspan id="SvgjsTspan1220" dy="15" x="10"><tspan id="SvgjsTspan1221" style="text-decoration:;">法列表中分别选择一个用于此次通信，并将服</tspan></tspan><tspan id="SvgjsTspan1222" dy="15" x="10"><tspan id="SvgjsTspan1223" style="text-decoration:;">务器证书发送给客户端用于身份验证</tspan></tspan></text></g></g><g id="SvgjsG1224" transform="translate(31,123)"><path id="SvgjsPath1225" d="M 126 0Q 117 0 117 9L 117 100Q 117 109 104 109Q 117 109 117 118L 117 209Q 117 218 126 218" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1226" d="M 0 0L 126 0L 126 218L 0 218Z" stroke="none" fill="none"></path><g id="SvgjsG1227"><text id="SvgjsText1228" font-family="Arial" text-anchor="end" font-size="13px" width="78" fill="#323232" font-weight="400" align="middle" anchor="end" family="Arial" size="13px" weight="400" font-style="" y="91.05" transform="rotate(0)"><tspan id="SvgjsTspan1229" dy="16" x="99"><tspan id="SvgjsTspan1230" style="text-decoration:;">协商加密套件</tspan></tspan><tspan id="SvgjsTspan1231" dy="16" x="99"><tspan id="SvgjsTspan1232" style="text-decoration:;">进行身份验证</tspan></tspan></text></g></g><g id="SvgjsG1233" transform="translate(31,378)"><path id="SvgjsPath1234" d="M 126 0Q 117 0 117 9L 117 100Q 117 109 104 109Q 117 109 117 118L 117 209Q 117 218 126 218" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1235" d="M 0 0L 126 0L 126 218L 0 218Z" stroke="none" fill="none"></path><g id="SvgjsG1236"><text id="SvgjsText1237" font-family="Arial" text-anchor="end" font-size="13px" width="78" fill="#323232" font-weight="400" align="middle" anchor="end" family="Arial" size="13px" weight="400" font-style="" y="99.05" transform="rotate(0)"><tspan id="SvgjsTspan1238" dy="16" x="99"><tspan id="SvgjsTspan1239" style="text-decoration:;">建立共享密钥</tspan></tspan></text></g></g><g id="SvgjsG1240" transform="translate(25,650)"><path id="SvgjsPath1241" d="M 129 0Q 120 0 120 5.5L 120 22Q 120 27.5 107 27.5Q 120 27.5 120 33L 120 49.5Q 120 55 129 55" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1242" d="M 0 0L 129 0L 129 55L 0 55Z" stroke="none" fill="none"></path><g id="SvgjsG1243"><text id="SvgjsText1244" font-family="Arial" text-anchor="end" font-size="13px" width="78" fill="#323232" font-weight="400" align="middle" anchor="end" family="Arial" size="13px" weight="400" font-style="" y="17.55" transform="rotate(0)"><tspan id="SvgjsTspan1245" dy="16" x="102"><tspan id="SvgjsTspan1246" style="text-decoration:;">应用数据传输</tspan></tspan></text></g></g></svg>